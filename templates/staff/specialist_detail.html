{% extends 'base.html' %}
{% load static %}

{% block title %}{{ specialist.last_name }} {{ specialist.first_name }} - {{ specialist.position }}{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <div class="container">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'core:home' %}">Главная</a></li>
            <li class="breadcrumb-item">
                <a href="{% url 'staff:specialist_detail' specialist.slug %}">Специалисты</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
                {{ specialist.last_name }} {{ specialist.first_name }}
            </li>
        </ol>
    </div>
</nav>

<section class="detail spec-detail rehab-help">
    <div class="container">
        <div class="detail__content rehab-help__content">
            <div class="detail__content-item detail__content-item--img rehab-help__content-item rehab-help__image">
                {% if specialist.photo %}
                    <img src="{{ specialist.photo.url }}" alt="{{ specialist.last_name }} {{ specialist.first_name }}" />
                {% else %}
                    <img src="{% static 'deps/img/notImage.svg' %}" alt="{{ specialist.last_name }} {{ specialist.first_name }}" />
                {% endif %}
            </div>
            <div class="detail__content-wrapper detail__content-item rehab-help__content-item">
                <h2 class="title__h2 detail__title">{{ specialist.last_name }} {{ specialist.first_name }}</h2>
                <div class="detail__text spec-detail__text">
                    <p>{{ specialist.position|default:'' }}</p>
                    {% if specialist.facility and specialist.facility.city %}
                    <div itemscope itemtype="https://schema.org/PostalAddress">
                        <span itemprop="addressRegion">{{ specialist.facility.city.region.name }}</span>,
                        <span itemprop="addressCountry">Россия</span>
                    </div>
                    {% endif %}
                </div>
                
                {% if specialist.facility and specialist.facility.slug %}
                <div class="card">
                    <a href="{% if specialist.facility.organization_type.slug == 'clinic' %}{% url 'facilities:clinic_detail' specialist.facility.slug %}{% else %}{% url 'facilities:rehab_detail' specialist.facility.slug %}{% endif %}">
                        <div class="card__image">
                            {% if specialist.facility.images.first %}
                                <img src="{{ specialist.facility.images.first.image.url }}" alt="{{ specialist.facility.name }}" />
                            {% else %}
                                <img src="{% static 'deps/img/notImage.svg' %}" alt="{{ specialist.facility.name }}" />
                            {% endif %}
                        </div>
                        <div class="card__content">
                            <h3 class="card__title title__h4">{{ specialist.facility.name }}</h3>
                            <p class="card__description">
                                {% if specialist.facility.city %}
                                    {{ specialist.facility.city.name }}{% if specialist.facility.city.region %}, {{ specialist.facility.city.region.name }}{% endif %}
                                {% endif %}
                            </p>
                            {% if specialist.facility.min_price %}
                            <div class="card__price">
                                <span class="card__price-value">от {{ specialist.facility.min_price }} P / месяц</span>
                            </div>
                            {% endif %}
                        </div>
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<section class="detail__info spec-detail__info">
    <div class="container">
        <div class="detail-content__wrapper">
            <h3 class="title__h3 detail__title">Образование</h3>
            <div class="spec-detail__wrapper">
                <div class="spec-detail__text">
                    <p>{{ specialist.education|default:'Информация об образовании не указана' }}</p>
                </div>
            </div>
        </div>
        
        {% if specialist.biography %}
        <div class="detail-content__wrapper detail-content__wrapper-second">
            <h3 class="title__h3 detail__title">Биография</h3>
            <div class="spec-detail__wrapper">
                <div class="spec-detail__text">
                    <p>{{ specialist.biography }}</p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<section class="detail-docs clinic-detail__docs">
    <div class="container">
        <h3 class="title__h3 detail__title">Лицензии и документы</h3>
        <div class="detail-doc__images">
            <div class="detail-docs__slider">
                {% for doc in documents %}
                <div class="detail-docs__image spec-detail__docs--image">
                    {% if doc.document %}
                    <a href="{{ doc.document.url }}" data-lightbox="specialist-docs" data-title="{{ doc.title|default:doc.document.name }}">
                        <img src="{{ doc.document.url }}" alt="{{ doc.title }}" />
                    </a>
                    {% else %}
                    <img src="{% static 'deps/img/notImage.svg' %}" alt="{{ doc.title }}" />
                    {% endif %}
                </div>
                {% empty %}
                <div class="detail-docs__image spec-detail__docs--image">
                    <img src="{% static 'deps/img/notImage.svg' %}" alt="Документы не загружены" />
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<section class="detail__reviews">
    <div class="container">
        <h3 class="title__h3 detail__title">Отзывы пациентов о центре</h3>
        <div class="detail__reviews-slider">
            {% if specialist.facility %}
                {% for review in specialist.facility.reviews.all %}
                <div class="detail__review">
                    <h4 class="title__h4 detail__review-title">
                        {{ review.author_name }}, {{ review.author_age }} лет
                    </h4>
                    <p>{{ review.content }}</p>
                </div>
                {% empty %}
                <div class="detail__review">
                    <p>Пока нет отзывов о центре</p>
                </div>
                {% endfor %}
            {% else %}
            <div class="detail__review">
                <p>Информация об учреждении не указана</p>
            </div>
            {% endif %}
        </div>
    </div>
</section>

{% include "facilities/includes/consultation.html" %}
{% endblock %} 