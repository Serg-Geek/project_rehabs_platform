{% extends 'base.html' %}
{% load static %}
{% load russian_plural %}

{% block title %}{{ doctor.get_full_name }} - Частный врач{% endblock %}

{% block extra_css %}
{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <div class="container">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'core:home' %}">Главная</a></li>
            {% if from_service_obj %}
                <li class="breadcrumb-item">
                    <a href="{% url 'medical_services:service_detail' from_service_obj.slug %}">{{ from_service_obj.name }}</a>
                </li>
            {% else %}
                <li class="breadcrumb-item">
                    <a href="{% url 'facilities:private_doctors_list' %}">Частные врачи</a>
                </li>
            {% endif %}
            <li class="breadcrumb-item active" aria-current="page">{{ doctor.get_full_name }}</li>
        </ol>
    </div>
</nav>

<section class="detail spec-detail rehab-help">
    <div class="container">
        <div class="detail__content rehab-help__content">
            <div class="detail__content-item detail__content-item--img rehab-help__content-item rehab-help__image">
                {% if doctor.main_image %}
                    <img src="{{ doctor.main_image.image.url }}" alt="{{ doctor.get_full_name }}" />
                {% else %}
                    <img src="{% static 'deps/img/notImage.svg' %}" alt="{{ doctor.get_full_name }}" />
                {% endif %}
            </div>
            <div class="detail__content-wrapper detail__content-item rehab-help__content-item">
                <h2 class="title__h2 detail__title">{{ doctor.get_full_name }}</h2>
                <div class="detail__text spec-detail__text rehab-help__text">
                    <h3 class="title__h3 detail__title">Оказывает услуги</h3>
                    <ul class="detail__services-list spec-detail__services-list">
                        {% for facility_service in services %}
                        <li>
                          <a href="{% url 'medical_services:service_detail' facility_service.service.slug %}">
                            {{ facility_service.service.name }}
                          </a>
                        </li>
                        {% empty %}
                        <li>Услуги не указаны</li>
                        {% endfor %}
                    </ul>
                </div>
                
                {% if doctor.consultation_price or doctor.home_visit_price %}
                <div class="doctor-prices">
                    {% if doctor.consultation_price %}
                    <div class="price-item">
                        <span class="price-label">Консультация:</span>
                        <span class="price-value">{{ doctor.consultation_price }} ₽</span>
                    </div>
                    {% endif %}
                    {% if doctor.home_visit_price %}
                    <div class="price-item">
                        <span class="price-label">Выезд на дом:</span>
                        <span class="price-value">{{ doctor.home_visit_price }} ₽</span>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<section class="detail__info spec-detail__info">
    <div class="container">
        {% if doctor.education %}
        <div class="detail-content__wrapper">
            <h3 class="title__h3 detail__title">Образование</h3>
            <div class="spec-detail__wrapper">
                <div class="spec-detail__text">
                    <p>{{ doctor.education }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% if doctor.biography %}
        <div class="detail-content__wrapper detail-content__wrapper-second">
            <h3 class="title__h3 detail__title">О враче</h3>
            <div class="spec-detail__wrapper">
                <div class="spec-detail__text">
                    <p>{{ doctor.biography }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% if doctor.achievements %}
        <div class="detail-content__wrapper detail-content__wrapper-second">
            <h3 class="title__h3 detail__title">Достижения</h3>
            <div class="spec-detail__wrapper">
                <div class="spec-detail__text">
                    <p>{{ doctor.achievements }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        {% if doctor.special_equipment %}
        <div class="detail-content__wrapper detail-content__wrapper-second">
            <h3 class="title__h3 detail__title">Специальное оборудование</h3>
            <div class="spec-detail__wrapper">
                <div class="spec-detail__text">
                    <p>{{ doctor.special_equipment }}</p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

{% if doctor.documents.all %}
<section class="detail-docs clinic-detail__docs">
    <div class="container">
        <h3 class="title__h3 detail__title">Документы специалиста</h3>
        <div class="detail-doc__images">
            <div class="detail-docs__slider">
                {% for doc in doctor.documents.all %}
                <div class="detail-docs__image spec-detail__docs--image">
                    {% if doc.document %}
                    <a href="{{ doc.document.url }}" data-lightbox="doctor-docs" data-title="{{ doc.title|default:doc.document.name }}">
                        <img src="{{ doc.document.url }}" alt="{{ doc.title }}" />
                    </a>
                    {% else %}
                    <img src="{% static 'deps/img/notImage.svg' %}" alt="{{ doc.title }}" />
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>
{% endif %}

{% if reviews %}
<section class="detail__reviews">
    <div class="container">
        <h3 class="title__h3 detail__title">Отзывы пациентов</h3>
        <div class="detail__reviews-slider">
            {% for review in reviews %}
            <div class="detail__review">
                <h4 class="title__h4 detail__review-title">
                    {{ review.author_name }}{% if review.author_age %}, {{ review.author_age }} лет{% endif %}
                </h4>
                <p>{{ review.content }}</p>
            </div>
            {% empty %}
            <div class="detail__review">
                <p>Пока нет отзывов</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

{% if related_doctors %}
<section class="detail-rehabs rehabs">
    <div class="container">
        <h3 class="title__h3 detail-rehabs__title">Другие специалисты в вашем регионе</h3>
        <div class="section__content">
            <div class="doctors__cards">
                {% for related_doctor in related_doctors %}
                {% include "includes/cards/private_doctor_card.html" with doctor=related_doctor %}
                {% endfor %}
            </div>
        </div>
    </div>
</section>
{% endif %}

{% include "facilities/includes/consultation.html" %}
{% endblock %} 