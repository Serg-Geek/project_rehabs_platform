# Руководство по работе с приложением «Блог»

## Общее описание

Приложение `blog` реализует публикацию и управление статьями (постами), категориями, тегами, поддерживает иерархию, фильтрацию, поиск, SEO, вывод на главную страницу, работу с изображениями и удобную админку.

---

## 1. Структура моделей

### BlogCategory (Категории блога)

- **Назначение:** группировка постов по тематикам, поддержка иерархии (родительская категория).
- **Ключевые поля:**
  - `name` — название
  - `slug` — URL-идентификатор (автоматически)
  - `description` — описание
  - `parent` — родительская категория
  - `order` — порядок отображения

### BlogPost (Пост блога)

- **Назначение:** основная сущность — статья/пост.
- **Ключевые поля:**
  - `title` — заголовок
  - `slug` — URL-идентификатор (автоматически)
  - `category` — категория поста
  - `preview_text` — краткое описание
  - `content` — основной текст
  - `image` — основное изображение
  - `is_published` — опубликован ли пост
  - `is_featured` — отображать на главной странице
  - `publish_date` — дата публикации
  - `meta_title`, `meta_description` — SEO
  - `views_count` — просмотры
  - `conclusion_text` — заключение
  - `tags` — теги (M2M через BlogPostTag)
- **Методы:**
  - `get_absolute_url()` — ссылка на пост
  - `get_tags_with_icons()` — теги с иконками для шаблонов

### Tag (Теги)

- **Назначение:** тематические метки для постов.
- **Ключевые поля:**
  - `name`, `slug`, `icon`, `description`, `is_active`, `is_system`, `created_at`, `updated_at`
- **Методы:**
  - `get_icon_path()` — путь к иконке для системных тегов

#### Системные теги с иконками

- **Системные теги** (`is_system=True`) могут отображаться с иконками в интерфейсе.
- Путь к иконке определяется автоматически по slug тега через словарь `SYSTEM_TAG_ICONS` в модели `Tag`.
- Если тег не системный или slug не совпадает с ключом в словаре — иконка не выводится.

**Стандартные системные теги и их иконки:**

| slug                           | Название (пример)             | Иконка (путь)                                          |
| ------------------------------ | ----------------------------- | ------------------------------------------------------ |
| profilaktika-i-preduprezhdenie | Профилактика и предупреждение | deps/icons/articles_tags_icons/prevention-icon.svg     |
| yuridicheskaya-konsultatsiya   | Юридическая консультация      | deps/icons/articles_tags_icons/justice-hammer-icon.svg |
| psihiatriya                    | Психиатрия                    | deps/icons/articles_tags_icons/psychiatrist-icon.svg   |
| psihologiya                    | Психология                    | deps/icons/articles_tags_icons/psychologist-icon.svg   |
| rodstvennikam                  | Родственникам                 | deps/icons/articles_tags_icons/clients-icon.svg        |
| narkomaniya                    | Наркомания                    | deps/icons/articles_tags_icons/medicine-icon.svg       |
| alkogolizm                     | Алкоголизм                    | deps/icons/articles_tags_icons/alcohol-icon.svg        |

**Как добавить свой тег с иконкой:**

1. Создайте тег в админке, укажите нужный slug.
2. Установите флаг **Системный тег** (`is_system=True`).
3. Добавьте путь к иконке в словарь `SYSTEM_TAG_ICONS` в модели `Tag` (при необходимости).

**Пример вывода иконки в шаблоне:**

```django
{% if tag.is_system and tag.get_icon_path %}
  <img src="{% static tag.get_icon_path %}" alt="{{ tag.name }}" class="tag-icon" />
{% endif %}
```

### BlogPostTag (Связь постов и тегов)

- **Назначение:** промежуточная модель для M2M BlogPost ↔ Tag
- **Ключевые поля:** `post`, `tag`

### BlogImage (Доп. изображения)

- **Назначение:** дополнительные изображения для поста
- **Ключевые поля:** `post`, `image`, `title`, `description`, `order`

---

## 2. Админка

- Все основные сущности зарегистрированы в админке.
- **BlogPost**:
  - Inline для тегов (BlogPostTagInline)
  - Фильтры: публикация, категория, наличие на главной
  - Поиск по названию, содержанию, SEO
  - Поля SEO и публикации свернуты
  - Просмотр и редактирование просмотров (views_count)
- **Tag**:
  - Фильтр по активности и системности
  - Быстрое добавление slug
- **Категории**:
  - Иерархия, сортировка, поиск

---

## 3. Работа с постами

### Создание поста

1. В админке: **Блог → Посты блога → Добавить**
2. Заполнить поля:
   - Заголовок, slug (автоматически), категория, превью, контент, изображение
   - Отметить **Опубликовано** для публикации
   - Отметить **На главной странице** для вывода карточки на главной
   - Добавить теги (через BlogPostTag)
   - Заполнить SEO (по желанию)
3. Сохранить

### Добавление тегов

- Можно выбрать существующие или создать новые
- Системные теги отображаются с иконками

### Изображения

- Основное изображение — поле `image`
- Дополнительные — через BlogImage

### Публикация на главной

- Отметить **На главной странице** (`is_featured=True`)
- На главной выводятся только опубликованные посты с этим флагом (максимум 3)

---

## 4. Фронтенд и шаблоны

- **Карточки постов**: используются include-шаблоны (`blog/includes/useful_info_card.html`)
- **Список постов**: шаблон `blog/post_list.html` с фильтрацией по тегам, категориям, поиском
- **Карточки на главной**: используются те же include-шаблоны, что и в блоге

---

## 5. Фильтрация и поиск

- Поиск по названию, содержанию, превью
- Фильтрация по тегам (системные теги с иконками)
- Фильтрация по категориям (иерархия)
- Сортировка по дате публикации

---

## 6. SEO и просмотры

- Для каждого поста можно задать meta title и meta description
- Счетчик просмотров увеличивается при каждом просмотре поста

### Заполнение SEO полей

**SEO (Search Engine Optimization)** — это оптимизация для поисковых систем, которая помогает постам лучше индексироваться и отображаться в результатах поиска.

#### Meta Title (Заголовок страницы)

- **Что это:** заголовок, который отображается во вкладке браузера и в результатах поиска
- **Длина:** рекомендуется 50-60 символов
- **Пример:**
  - Пост: "Как распознать зависимость на ранних стадиях"
  - Meta Title: "Признаки зависимости: как выявить проблему на ранних этапах | Центр помощи"

#### Meta Description (Описание страницы)

- **Что это:** краткое описание поста, которое показывается в результатах поиска
- **Длина:** рекомендуется 150-160 символов
- **Пример:**
  - Meta Description: "Узнайте, как распознать признаки зависимости на ранних стадиях. Советы специалистов по выявлению проблем с алкоголем и наркотиками."

#### Как заполнять SEO в админке:

1. В форме создания/редактирования поста разверните секцию **SEO** (нажмите на заголовок)
2. В поле **Meta Title** введите оптимизированный заголовок
3. В поле **Meta Description** введите краткое описание
4. Если поля оставить пустыми, будут использованы автоматически сгенерированные значения

#### Рекомендации по SEO:

- **Уникальность:** каждый пост должен иметь уникальные title и description
- **Ключевые слова:** включайте основные ключевые слова в заголовок и описание
- **Привлекательность:** делайте описание интересным для пользователей
- **Длина:** соблюдайте рекомендуемую длину для корректного отображения в поиске
- **Локальность:** для местных запросов включайте название города/региона

#### Пример заполнения для поста "Лечение алкоголизма в Краснодаре":

- **Meta Title:** "Лечение алкоголизма в Краснодаре - профессиональная помощь наркологов"
- **Meta Description:** "Эффективное лечение алкоголизма в Краснодаре. Консультации наркологов, детоксикация, кодирование. Анонимно и профессионально."

### Счетчик просмотров

- Поле `views_count` автоматически увеличивается при каждом просмотре поста
- В админке можно просматривать и редактировать количество просмотров
- Используется для анализа популярности контента

---

## 7. Рекомендации

- Используйте иерархию категорий для удобной навигации
- Для важных тем создавайте системные теги с иконками
- Для вывода на главную используйте флаг "На главной странице"
- Заполняйте SEO для лучшей индексации
- Следите за уникальностью slug

---

## 8. Типовые проблемы

- **Пост не отображается:**
  - Не отмечен как опубликованный
  - Не выбран тег/категория
  - Не заполнен slug
- **Карточка не на главной:**
  - Не отмечен флаг "На главной странице"
  - Не опубликован
- **Slug неуникален:**
  - Измените название или slug вручную

---

## 9. Примеры использования

### Пример 1: Создание поста для главной

1. Создайте пост, заполните все поля
2. Отметьте "Опубликовано" и "На главной странице"
3. Добавьте теги (например, "Алкоголизм", "Психология")
4. Сохраните — пост появится на главной и в общем списке

### Пример 2: Добавление системного тега

1. В разделе "Теги" создайте новый тег
2. Установите флаг "Системный тег" и укажите иконку
3. Используйте этот тег для постов — он будет отображаться с иконкой

---

## 10. Советы по поддержке

- Регулярно обновляйте контент
- Используйте фильтры и поиск для быстрого доступа к нужным постам
- Следите за актуальностью SEO и описаний
- Используйте предпросмотр для проверки отображения карточек

---

**Документация актуальна для версии Django 5.x и текущей структуры проекта.**
