@startuml
skinparam rankdir TB
title Архитектура моделей Django - Центр помощи зависимым

' Базовые модели
entity "TimeStampedModel" as TimeStampedModel {
    + id : int <<PK>>
    --
    created_at : datetime
    updated_at : datetime
}

' Core приложение
entity "Region" as Region {
    + id : int <<PK>>
    --
    name : string
    slug : string
}

entity "City" as City {
    + id : int <<PK>>
    --
    name : string
    slug : string
    region : Region <<FK>>
}

' Facilities приложение
entity "OrganizationType" as OrganizationType {
    + id : int <<PK>>
    --
    name : string
    slug : string
    description : text
    competencies : text
}

entity "AbstractMedicalFacility" as AbstractMedicalFacility {
    + id : int <<PK>>
    --
    name : string
    slug : string
    organization_type : OrganizationType <<FK>>
    description : text
    address : text
    phone : string
    email : string
    website : string
    license_number : string
    is_active : bool
    city : City <<FK>>
}

entity "RehabCenter" as RehabCenter {
    + id : int <<PK>>
    --
    capacity : int
    program_duration : int
    min_price : decimal
    accommodation_conditions : text
}

entity "Clinic" as Clinic {
    + id : int <<PK>>
    --
    emergency_support : bool
    has_hospital : bool
}

entity "PrivateDoctor" as PrivateDoctor {
    + id : int <<PK>>
    --
    first_name : string
    last_name : string
    middle_name : string
    experience_years : int
    education : text
    biography : text
    achievements : text
    office_description : text
    parking_available : bool
    wheelchair_accessible : bool
    schedule : text
    home_visits : bool
    emergency_available : bool
    weekend_work : bool
    consultation_price : decimal
    home_visit_price : decimal
    insurance_accepted : bool
    license_issue_date : date
    license_expiry_date : date
    online_consultations : bool
    video_consultations : bool
    special_equipment : text
}

entity "FacilityImage" as FacilityImage {
    + id : int <<PK>>
    --
    content_type : ContentType <<FK>>
    object_id : int
    image : ImageField
    image_type : string
    title : string
    description : text
    is_main : bool
    order : int
}

entity "FacilityDocument" as FacilityDocument {
    + id : int <<PK>>
    --
    content_type : ContentType <<FK>>
    object_id : int
    document_type : string
    title : string
    document : FileField
    number : string
    issue_date : date
    expiry_date : date
    is_active : bool
}

' Staff приложение
entity "Specialization" as Specialization {
    + id : int <<PK>>
    --
    name : string
    slug : string
    description : text
}

entity "FacilitySpecialist" as FacilitySpecialist {
    + id : int <<PK>>
    --
    content_type : ContentType <<FK>>
    object_id : int
    first_name : string
    last_name : string
    middle_name : string
    photo : ImageField
    experience_years : int
    education : text
    biography : text
    achievements : text
    is_active : bool
}

' Reviews приложение
entity "Review" as Review {
    + id : int <<PK>>
    --
    content_type : ContentType <<FK>>
    object_id : int
    rating : int
    content : text
}

' Связи наследования
AbstractMedicalFacility --|> TimeStampedModel
RehabCenter --|> AbstractMedicalFacility
Clinic --|> AbstractMedicalFacility
PrivateDoctor --|> AbstractMedicalFacility

' Связи Many-to-Many
PrivateDoctor ||--o{ Specialization : "specializations"

' Generic Relations
RehabCenter ||--o{ FacilityImage : "images"
Clinic ||--o{ FacilityImage : "images"
PrivateDoctor ||--o{ FacilityImage : "images"

RehabCenter ||--o{ FacilityDocument : "documents"
Clinic ||--o{ FacilityDocument : "documents"
PrivateDoctor ||--o{ FacilityDocument : "documents"

RehabCenter ||--o{ FacilitySpecialist : "specialists"
Clinic ||--o{ FacilitySpecialist : "specialists"
PrivateDoctor ||--o{ FacilitySpecialist : "specialists"

RehabCenter ||--o{ Review : "reviews"
Clinic ||--o{ Review : "reviews"
PrivateDoctor ||--o{ Review : "reviews"

' Связи Foreign Key
City ||--o{ AbstractMedicalFacility : "city"
OrganizationType ||--o{ AbstractMedicalFacility : "organization_type"
City ||--o{ Region : "region"

@enduml